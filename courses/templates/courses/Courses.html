{% load static %}
<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduPlatform — Курси</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height:1.6; color:#333; background:#f8fafc; }
        a { text-decoration:none; }

        .header { background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:#fff; padding:1rem 0; position:fixed; width:100%; top:0; z-index:1000; box-shadow:0 2px 20px rgba(0,0,0,.1);}
        .navbar { max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; padding:0 2rem;}
        .logo { font-size:1.8rem; font-weight:bold; color:#fff;}
        .nav-links { display:flex; list-style:none; gap:2rem;}
        .nav-links a { color:#fff; transition:opacity .3s ease;}
        .nav-links a:hover { opacity:.8;}
        .auth-buttons { display:flex; gap:1rem;}
        .btn { padding:.7rem 1.5rem; border:none; border-radius:25px; transition:.3s ease; font-weight:500; cursor:pointer; display:inline-block;}
        .btn-outline { background:transparent; color:#fff; border:2px solid #fff; }
        .btn-outline:hover { background:#fff; color:#667eea; }
        .btn-primary { background:#ff6b6b; color:#fff; }
        .btn-primary:hover { background:#ff5252; transform:translateY(-2px); }

        .filters-panel { background: white; padding: 2rem; border-radius: 15px; margin-bottom: 2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.1);}
        .filters-row { display: grid; grid-template-columns: 1fr 1fr 1fr 2fr; gap: 1.5rem; align-items: end; margin-bottom: 1rem;}
        .filter-group { display:flex; flex-direction:column;}
        .filter-label { font-weight:600; color:#4a5568; margin-bottom:.5rem; font-size:.9rem;}
        .input, .select { padding:.8rem 1rem; border:1px solid #e2e8f0; border-radius:12px; background:#fff; outline:none; transition:border-color .3s;}
        .input:focus, .select:focus { border-color:#667eea; box-shadow:0 0 0 3px rgba(102,126,234,0.1);}
        .price-range { display:flex; gap:0.75rem; align-items:center;}
        .price-input { flex:1; padding:.6rem .8rem; border:1px solid #e2e8f0; border-radius:8px; text-align:center; outline:none; transition:border-color .3s;}
        .price-input:focus { border-color:#667eea;}
        .price-separator { color:#718096; font-weight:500;}
        .filter-actions { display:flex; gap:1rem; justify-content:flex-end; margin-top:1rem;}
        .btn-secondary { background:#e2e8f0; color:#4a5568; padding:.6rem 1.2rem; border:none; border-radius:8px; cursor:pointer; transition:all .3s;}
        .btn-secondary:hover { background:#cbd5e0;}
        .btn-apply { background: linear-gradient(135deg, #667eea, #764ba2); color:white; padding:.6rem 1.5rem; border:none; border-radius:8px; cursor:pointer; transition:all .3s;}
        .btn-apply:hover { transform:translateY(-1px); box-shadow:0 4px 12px rgba(102,126,234,.3);}

        .hero { background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); padding:120px 0 60px; text-align:center; color:#fff; position:relative; overflow:hidden;}
        .hero-content { max-width:1200px; margin:0 auto; padding:0 2rem; position:relative; z-index:1;}
        .hero h1 { font-size:3rem; margin-bottom:.5rem;}
        .hero p { font-size:1.15rem; opacity:.95;}

        .container { max-width:1200px; margin:0 auto; padding:0 2rem;}
        .section-title { text-align:center; margin:2.5rem 0 1.5rem;}
        .section-title h2 { font-size:2rem; color:#2d3748;}
        .section-title p { color:#718096;}

        .courses { padding:60px 0 90px; background:#f7fafc;}
        .courses-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:2rem;}
        .course-card { background:#fff; border-radius:15px; overflow:hidden; box-shadow:0 10px 30px rgba(0,0,0,.1); transition: transform .3s ease, box-shadow .3s ease;}
        .course-card:hover { transform:translateY(-6px); box-shadow:0 20px 40px rgba(0,0,0,.15);}
        .course-image { height:200px; background:linear-gradient(45deg,#667eea,#764ba2); display:flex; align-items:center; justify-content:center; color:#fff; font-size:3rem;}
        .course-image img { width:100%; height:100%; object-fit:cover; display:block;}
        .course-content { padding:1.25rem;}
        .course-title { font-size:1.25rem; margin-bottom:.4rem; color:#2d3748;}
        .course-description { color:#718096; margin-bottom:1rem;}
        .course-meta { display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;}
        .course-price { font-size:1.1rem; font-weight:700; color:#667eea;}
        .course-rating { color:#fbb040;}
        .btn-block { width:100%; display:block; text-align:center;}

        .footer { background:#2d3748; color:#fff; padding:40px 0; text-align:center;}
        .footer-content { max-width:1200px; margin:0 auto; padding:0 2rem;}
        .footer-links { display:flex; justify-content:center; gap:2rem; margin-bottom:1.25rem; flex-wrap:wrap;}
        .footer-links a { color:#fff; opacity:.85;}
        .footer-links a:hover { opacity:1;}

        .course-card.hidden { display:none !important;}
        .fade-in { opacity:0; transform:translateY(30px); transition: all .6s ease;}
        .fade-in.visible { opacity:1; transform:translateY(0);}

        @media (max-width:768px) {
            .nav-links { display:none; }
            .hero h1 { font-size:2.2rem; }
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="navbar">
            <a href="/" class="logo"><i class="fas fa-graduation-cap"></i> EduPlatform.TMWORK</a>
            <ul class="nav-links">
                <li><a href="/">Головна</a></li>
                <li><a href="/courses/">Курси</a></li>
                <li><a href="/about/">Про нас</a></li>
                <li><a href="/contacts/">Контакти</a></li>
            </ul>
            <div class="auth-buttons">
                {% if user.is_authenticated %}
                    <a class="btn btn-outline"><i class="fas fa-user"></i> {{ user.username }}</a>
                    <a href="/admin/logout/" class="btn btn-primary">Вийти</a>
                {% else %}
                    <a href="/admin/login/" class="btn btn-outline">Увійти</a>
                    <a href="#" class="btn btn-primary">Реєстрація</a>
                {% endif %}
            </div>
        </nav>
    </header>

    <section class="hero">
        <div class="hero-content">
            <h1>Курси</h1>
            <p>Оберіть напрям та почніть навчання вже сьогодні</p>
        </div>
    </section>

    <section class="courses">
        <div class="container">
            <div class="section-title fade-in">
                <h2>Усі курси платформи</h2>
                <p>Всі доступні курси. Використовуйте фільтри для пошуку.</p>
            </div>

            <div class="filters-panel fade-in">
                <div class="filters-row">
                    <div class="filter-group">
                        <label class="filter-label">Пошук</label>
                        <input class="input" type="text" id="searchInput" placeholder="Назва курсу..." />
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Категорія</label>
                        <select class="select" id="categoryFilter">
                            <option value="">Усі категорії</option>
                            {% for cat in categories %}
                                <option value="{{ cat.slug }}">{{ cat.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Сортування</label>
                        <select class="select" id="sortFilter">
                            <option value="popular">За популярністю</option>
                            <option value="price-asc">За ціною (зростання)</option>
                            <option value="price-desc">За ціною (спадання)</option>
                            <option value="rating">За рейтингом</option>
                            <option value="name">За назвою</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Ціна (грн)</label>
                        <div class="price-range">
                            <input type="number" class="price-input" id="priceMin" placeholder="Від" min="0">
                            <span class="price-separator">—</span>
                            <input type="number" class="price-input" id="priceMax" placeholder="До" min="0">
                            <label style="margin-left:1rem;">
                                <input type="checkbox" id="freeOnly"> Тільки безкоштовні
                            </label>
                        </div>
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="btn-secondary" onclick="clearFilters()">Скинути</button>
                    <button class="btn-apply" onclick="applyFilters()">Застосувати</button>
                </div>
                <div id="noResults" style="display:none; text-align:center; margin-top:20px;">
                    <p>Нічого не знайдено 😕</p>
                </div>
            </div>

            <div id="searchResults" class="search-results" style="display:none;">
                <strong>Знайдено курсів:</strong> <span id="resultsCount">0</span>
            </div>

            <div class="courses-grid" id="coursesGrid">
                {% for course in courses %}
                    <div class="course-card fade-in"
                        data-title="{{ course.title|lower }}"
                        data-category="{{ course.category.slug }}"
                        data-price="{{ course.price|floatformat:0 }}"
                        data-rating="{{ course.rating|default:0 }}">
                        <div class="course-image">
                            {% if course.image %}
                                <img src="{{ course.image.url }}" alt="{{ course.title }}">
                            {% else %}
                                <i class="fas fa-book-open"></i>
                            {% endif %}
                        </div>
                        <div class="course-content">
                            <h3 class="course-title">{{ course.title }}</h3>
                            <p class="course-description">{{ course.short_description|truncatewords:22 }}</p>
                            <div class="course-meta">
                                <span class="course-price">
                                    {% if course.price == 0 %}Безкоштовно{% else %}{{ course.price }} грн{% endif %}
                                </span>
                                <div class="course-rating">
                                    {% for i in "12345" %}
                                        {% if forloop.counter <= course.rating|default:4 %}
                                            <i class="fas fa-star"></i>
                                        {% else %}
                                            <i class="far fa-star"></i>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                            <a href="{% url 'courses:course_detail' course.slug %}" class="btn btn-primary btn-block">Детальніше</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="/about/">Про нас</a>
                <a href="/contacts/">Контакти</a>
                <a href="/privacy-policy/">Політика конфіденційності</a>
                <a href="/terms-of-use/">Умови використання</a>
            </div>
            <p>&copy; 2025 EduPlatform. Всі права захищені.</p>
        </div>
    </footer>

    <script>
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            const sortBy = document.getElementById('sortFilter').value;
            const priceMin = parseInt(document.getElementById('priceMin').value) || 0;
            const priceMax = parseInt(document.getElementById('priceMax').value) || Infinity;
            const freeOnly = document.getElementById('freeOnly').checked;

            let courses = Array.from(document.querySelectorAll('.course-card'));
            let visibleCount = 0;

            courses.forEach(course => {
                let title = course.dataset.title.toLowerCase();
                let courseCategory = course.dataset.category;
                let price = parseInt(course.dataset.price);
                let isVisible = true;

                if(searchTerm && !title.includes(searchTerm)) isVisible = false;
                if(category && courseCategory !== category) isVisible = false;
                if(freeOnly && price !== 0) isVisible = false;
                else if(!freeOnly && (price < priceMin || price > priceMax)) isVisible = false;

                if(isVisible) {
                    course.classList.remove('hidden');
                    visibleCount++;
                } else {
                    course.classList.add('hidden');
                }
            });

            const visibleCourses = courses.filter(c => !c.classList.contains('hidden'));
            sortCourses(visibleCourses, sortBy);

            document.getElementById('resultsCount').textContent = visibleCount;
            document.getElementById('searchResults').style.display = 'block';
            document.getElementById('noResults').style.display = (visibleCount === 0) ? 'block' : 'none';
        }

        function sortCourses(courses, sortBy) {
            const grid = document.getElementById('coursesGrid');
            courses.sort((a, b) => {
                switch(sortBy) {
                    case 'price-asc': return parseInt(a.dataset.price) - parseInt(b.dataset.price);
                    case 'price-desc': return parseInt(b.dataset.price) - parseInt(a.dataset.price);
                    case 'rating': return parseInt(b.dataset.rating) - parseInt(a.dataset.rating);
                    case 'name': return a.dataset.title.localeCompare(b.dataset.title);
                    default: return 0;
                }
            });
            courses.forEach(course => grid.appendChild(course));
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('sortFilter').value = 'popular';
            document.getElementById('priceMin').value = '';
            document.getElementById('priceMax').value = '';
            document.getElementById('freeOnly').checked = false;
            document.querySelectorAll('.course-card').forEach(c => c.classList.remove('hidden'));
            document.getElementById('searchResults').style.display = 'none';
            document.getElementById('noResults').style.display = 'none';
        }

        document.getElementById('searchInput').addEventListener('input', applyFilters);
        document.getElementById('categoryFilter').addEventListener('change', applyFilters);
        document.getElementById('sortFilter').addEventListener('change', applyFilters);
        document.getElementById('freeOnly').addEventListener('change', applyFilters);
        document.getElementById('priceMin').addEventListener('input', applyFilters);
        document.getElementById('priceMax').addEventListener('input', applyFilters);

        function handleScrollAnimations() {
            const elements = document.querySelectorAll('.fade-in');
            const wh = window.innerHeight;
            elements.forEach(el => {
                if(el.getBoundingClientRect().top < wh - 150) el.classList.add('visible');
            });
        }
        window.addEventListener('scroll', handleScrollAnimations);
        window.addEventListener('load', handleScrollAnimations);
    </script>
</body>
</html>
